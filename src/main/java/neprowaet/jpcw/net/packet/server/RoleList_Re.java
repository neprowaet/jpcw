package neprowaet.jpcw.net.packet.server;

import neprowaet.jpcw.data.AuthorizationData;
import neprowaet.jpcw.data.Handler;
import neprowaet.jpcw.io.Packet;
import neprowaet.jpcw.io.annotations.If;
import neprowaet.jpcw.io.annotations.Skip;
import neprowaet.jpcw.net.packet.types.ServerPacket;

public class RoleList_Re extends Packet implements Handler<AuthorizationData>, ServerPacket {

    @Skip(4)
    public long handle;
    @Skip(8)
    public boolean roleProvided; // <- TODO: add @CUInt annotation for PacketSerializator

    /*
    hardcoded reading 1st element in array of RoleInfo gametype objects
     */

    @If("roleProvided")
    public long roleid;

    /*
    public byte gender;
    public byte race;
    public byte occupation;
    public long level;

    @Skip(4)
    String name TODO: add functionality for reading strings in PacketSerializator
     */


    @Override
    public void handleData(AuthorizationData data) { /* <-- TODO: replace with RoleInfoData */
        if(roleProvided) {
            data.addRole(this.roleid);
        }
    }
}

/*
                      @see neprowaet.jpcw.net.packet.client.RoleList
NOTE: Retrieving characters processes with series of (RoleList->Rolelist_Re) packets, first RoleList
      goes with "handle" is set to -1 (0xFFFFFFFF), then its' RoleList_Re answer comes with "handle" for
      the next RoleList request. Retrieving -1 "handle" in RoleList_Re again means reaching end of character list.

52 0C 000DB260 00000000 FFFFFFFF
53 81A6 00000000 00000000 000DB260 00027243 01 000C6090 00 02 04 00000001 00000000 16 6100640070006F006C006600690067006D0069006400 80B001700010593301004200420032C8C1002C0000009F4C000002FF79009F62B53AFFFE93779AC8C86428FB550028000A00160400E71A99663AFF00E71A99663AFF2E006301FF4A0C807A1FFF4A0C807A1F29003A004ABE68233700725F50004D005300FF948D4F3400D1D1FFFF3C00755CDB051206CC00BA003D01B101B501000000000000F8F8C800F8F800008AA2E1FF9CB6E4FFC7AE51FFFFFFFFFF0000000000000000FFFFFFFFFF423E444146000001000008D20000000000000001000000014C0100FF0F0500000005000000800C0000800C00002C0003000000000009000000000000000000000004000000080000000000000000000000160000000000604000000000000000000000000000000000000000000000000000000000000000010100000000607EB5306080D298C41B8B28435B0299C4AA7C99000000010000FFFFFFFF00000CE4120000000000000000000000000000000000001000000000000000000000000000000000

520C000DB2600000000000000000
53819C0000000000000001000DB2600002724301000C609100000800000001000000000C68006E006D0068006E00680080B0017000109B464E003E003E00326A8000FAD25C8D878EC0BC6A728479878487808782876487788D76956D470032003100731FB18DA1717C80A0B18DA1717C80A02D00460080738B56708080738B56708029003A00455F67803900408050004D00530056678980340053537A7A3C00638D08013901CC00BA005402B101B50100000F1D34FFFFFFFFFFDE5C3FFFFFFFFFFFF3F2F2FFF2F3F4FF37704FFF77040000000000000F1D34FF827279757C80000001000008310000000000000001000000014C0100FF010500000005000000F00A0000F00A00002C00010000000000010000000000000000000000040000000500000000000000000000001200000000004040000000000000000000000000000000000000000000000000000000000000000101000000006080A0276080D298C52150724307FC8AC53D21A4000000010000FFFFFFFF00000CE4120000000000000000000000000000000000001000000000000000000000000000000000

52 0C 000DB260 00000000 01000000
53 11 00000000 FFFFFFFF 000DB260 00027243 00

	<protocol debug="0" name="RoleList_Re" maxsize="8192" prior="101" type="83">
		<variable name="result" type="int"/>
		<variable name="handle" type="int"/>
		<variable name="userid" type="int"/>
		<variable name="localsid" type="unsigned int"/>
		<variable name="rolelist" type="RoleInfoVector"/>
	</protocol>
 */
